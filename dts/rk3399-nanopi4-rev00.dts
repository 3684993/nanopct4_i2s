// SPDX-License-Identifier: (GPL-2.0+ OR MIT)
/*
 * Copyright (c) 2020 FriendlyElec Computer Tech. Co., Ltd.
 * (http://www.friendlyarm.com)
 */

/dts-v1/;

/ {
    model = "FriendlyElec NanoPC-T4";
    compatible = "friendlyelec,nanopc-t4", "rockchip,rk3399";

    /* 音频节点 */
    sound {
        compatible = "simple-audio-card";
        simple-audio-card,name = "INMP441-Mic";
        simple-audio-card,format = "i2s";
        simple-audio-card,mclk-fs = <256>;
        status = "okay";

        simple-audio-card,cpu {
            sound-dai = <&i2s1>;
        };

        simple-audio-card,codec {
            sound-dai = <&inmp441>;
        };
    };

    inmp441: inmp441-codec {
        compatible = "invensense,inmp441";
        #sound-dai-cells = <0>;
        status = "okay";
    };

    /* 简化的时钟控制器 */
    cru: clock-controller {
        compatible = "rockchip,rk3399-cru";
        #clock-cells = <1>;
    };

    /* 简化的引脚控制器 */
    pinctrl: pinctrl {
        compatible = "rockchip,rk3399-pinctrl";
        #pinctrl-cells = <2>;
    };

    /* I2S1 节点 */
    i2s1: i2s1 {
        compatible = "rockchip,rk3399-i2s", "rockchip,rk3066-i2s";
        clocks = <&cru 0>, <&cru 1>;
        clock-names = "i2s_clk", "i2s_hclk";
        rockchip,playback-channels = <2>;
        rockchip,capture-channels = <2>;
        pinctrl-names = "default";
        pinctrl-0 = <&i2s1_2ch_bus>;
        status = "okay";
    };
};

/* I2S1 引脚配置 */
&pinctrl {
    i2s1 {
        i2s1_2ch_bus: i2s1-2ch-bus {
            rockchip,pins =
                <4 3 1 &pcfg_pull_none>, /* I2S1_SCLK */
                <4 4 1 &pcfg_pull_none>, /* I2S1_LRCK_RX */
                <4 5 1 &pcfg_pull_none>, /* I2S1_LRCK_TX */
                <4 6 1 &pcfg_pull_none>, /* I2S1_SDI0 */
                <4 7 1 &pcfg_pull_none>; /* I2S1_SDO0 */
        };
    };
};
